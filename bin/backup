#!/bin/bash

# a heavy simplification of the original script
# there is no longer any concept of snapshots, etc
# New model is as follows:
# A directory BACKUP_DIR contains content (regular files and symlinks) that is to be backed up
# ARCHIVE_DIR contains gpg encrypted, time stampped gzipped tarballs of BACKUP_DIR
# user can then run this as a regular cron job, or invoke whenever desired

# Data model definition
EMAIL="gajjanagadde@gmail.com"
NOW=$(date +%Y%m%d)
BACKUP_DIR="$HOME/backup"
ARCHIVE_DIR="$HOME/archive"
mkdir -p $BACKUP_DIR $ARCHIVE_DIR

# Create encrypted and compressed archives
tar -hczf $ARCHIVE_DIR/$NOW.tar.gz $BACKUP_DIR &>/dev/null
gpg -r $EMAIL -e $ARCHIVE_DIR/$NOW.tar.gz
rm -rf $ARCHIVE_DIR/$NOW.tar.gz
